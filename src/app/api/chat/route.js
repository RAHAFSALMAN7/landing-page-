export async function POST(req) {
  try {
    const body = await req.json();
    const userMessage = body?.message?.text?.toLowerCase() || "";

    // โ ุจูุงูุงุช ุฏูููุฉ ูู ูููุน "ููุฒูู ุงูุฑุงูู"
    const info = {
      name: "ููุฒูู ุงูุฑุงูู",
      slogan: "ุงูุฃูุงูุฉ ุชุจุฏุฃ ูู ุงูููุฒู โ ุฃุซุงุซ ูุงุฎุฑ ูุฌูุน ุจูู ุงููุฎุงูุฉ ูุงูุทุจูุนุฉ.",
      experience: "ูุฏููุง ุฃูุซุฑ ูู 7 ุณููุงุช ุฎุจุฑุฉ ูู ุชุตููู ุงูุฃุซุงุซ ุงููุงุฎุฑ.",
      branches: "ูุฏููุง ูุฑุนุงู ุฏุงุฎู ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ ๐ธ๐ฆ.",
      piecesSold: "ุชู ุจูุน ุฃูุซุฑ ูู 10,000 ูุทุนุฉ ุฃุซุงุซ ูุงุฎุฑุฉ ุญุชู ุงูุขู ๐ช.",
      designs: "ููุฏู ุฃูุซุฑ ูู 260 ุชุตููููุง ูููุฒูุง ููุงุณุจ ุฌููุน ุงูุฃุฐูุงู ๐จ.",
      delivery: "๐ ูููุฑ ุชูุตูู ูุฌุงูู ุฏุงุฎู ุงูุฑูุงุถ ุฎูุงู 48 ุณุงุนุฉ ูู ุฃุบูุจ ุงููุฏู.",
      warranty: "๐ก๏ธ ูุถูู ุฌูุฏุฉ ููุชุฌุงุชูุง ูุฃูุซุฑ ูู 10 ุณููุงุช.",
      contact: "๐ +966 920000000 โ โ๏ธ info@manzilk.com โ ๐ ุงูุฑูุงุถ - ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ",
      products:
        "๐ช ููุชุฌุงุชูุง ูุฃุณุนุงุฑูุง ุจุงูุฏููุงุฑ ุงูุฃูุฑููู:\n" +
        "- ูุฑุณู ูุฎู ูู ุงููุฎูู: $150\n" +
        "- ุฃุฑููุฉ ุซูุงุซูุฉ ูุงุฎุฑุฉ: $420\n" +
        "- ุทุงููุฉ ุทุนุงู ุฎุดุจ ุทุจูุนู: $350\n" +
        "- ุณุฑูุฑ ูููู ุจุชุตููู ุนุตุฑู: $720\n" +
        "- ุฅุถุงุกุฉ ุณูููุฉ ูุญุงุณูุฉ: $180\n" +
        "- ุฎุฒุงูุฉ ุฃูููุฉ ุจููุณุฉ ูุนุฏููุฉ: $310\n" +
        "- ูุฑุณู ุฌูุฏู ููููุชุจ: $230\n" +
        "- ููุชุจุฉ ุฌุฏุงุฑูุฉ ุฎุดุจูุฉ: $270\n",
      whyUs:
        "โจ ููุงุฐุง ุชุฎุชุงุฑูุงุ\n" +
        "- ุชูุตูู ุณุฑูุน ุฎูุงู 48 ุณุงุนุฉ ๐\n" +
        "- ุฏูุน ุขูู ูุณูู ๐ณ\n" +
        "- ุชุฑููุจ ูุฌุงูู ุจูุงุณุทุฉ ูุฑูู ูุญุชุฑู ๐งฐ\n" +
        "- ุถูุงู ุฌูุฏุฉ ูุฃูุซุฑ ูู 10 ุณููุงุช ๐ก๏ธ",
      reviews:
        "โญ ุขุฑุงุก ุนููุงุฆูุง:\n" +
        "ุณุงุฑุฉ ู.: ููุชุฌุงุช ูุงุฎุฑุฉ ูุฌูุฏุฉ ููุชุงุฒุฉ!\n" +
        "ุฎุงูุฏ ุฑ.: ุฎุฏูุฉ ุฑุงุฆุนุฉ ูุณุฑุนุฉ ูู ุงูุชูุตูู ๐\n" +
        "ูููู ู.: ุงูุฃุซุงุซ ุฃุฌูู ูู ุงูุตูุฑุ ุฑุงูู ุฌุฏูุง!",
    };

    let reply =
      "ูุฑุญุจูุง ๐ ุฃูุง ูุณุงุนุฏ *ููุฒูู ุงูุฑุงูู*ุ ุฌุงูุฒ ูุฃุณุงุนุฏู ุจูู ูุง ุชุญุชุงุฌู ุญูู ุงูุฃุซุงุซุ ุงูุฃุณุนุงุฑุ ูุงูุชูุตูู.";

    // ๐ง ููุทู ุงูุฑุฏูุฏ ุงูุฏูููุฉ ุจูุงุกู ุนูู ุงูุฃุณุนุงุฑ ุงูุญููููุฉ
    if (userMessage.includes("ูุฑุญุจุง") || userMessage.includes("ุงูุณูุงู")) {
      reply = "ุฃูููุง ูุณูููุง ุจู ูู *ููุฒูู ุงูุฑุงูู* ๐ฟ! ููู ูููููู ุฎุฏูุชู ุงููููุ";
    } else if (userMessage.includes("ููุชุฌุงุช") || userMessage.includes("ุฃุซุงุซ") || userMessage.includes("ุณุนุฑ")) {
      reply = info.products;
    } else if (userMessage.includes("ูุฑุณู") && userMessage.includes("ูุฎูู")) {
      reply = "๐บ ุณุนุฑ ุงููุฑุณู ุงููุฎู ูู ุงููุฎูู ูู *$150*.";
    } else if (userMessage.includes("ุฃุฑููุฉ") || userMessage.includes("ููุจุฉ")) {
      reply = "๐๏ธ ุณุนุฑ ุงูุฃุฑููุฉ ุงูุซูุงุซูุฉ ุงููุงุฎุฑุฉ ูู *$420*.";
    } else if (userMessage.includes("ุทุงููุฉ")) {
      reply = "๐ฝ๏ธ ุณุนุฑ ุทุงููุฉ ุงูุทุนุงู ุงูุฎุดุจูุฉ ุงูุทุจูุนูุฉ ูู *$350*.";
    } else if (userMessage.includes("ุณุฑูุฑ")) {
      reply = "๐๏ธ ุณุนุฑ ุงูุณุฑูุฑ ุงููููู ุจุชุตููู ุนุตุฑู ูู *$720*.";
    } else if (userMessage.includes("ุฅุถุงุกุฉ") || userMessage.includes("ููุจุฉ")) {
      reply = "๐ก ุณุนุฑ ุงูุฅุถุงุกุฉ ุงูุณูููุฉ ุงููุญุงุณูุฉ ูู *$180*.";
    } else if (userMessage.includes("ุฎุฒุงูุฉ")) {
      reply = "๐ช ุณุนุฑ ุงูุฎุฒุงูุฉ ุงูุฃูููุฉ ุจููุณุฉ ูุนุฏููุฉ ูู *$310*.";
    } else if (userMessage.includes("ูุฑุณู") && userMessage.includes("ููุชุจ")) {
      reply = "๐ช ุณุนุฑ ุงููุฑุณู ุงูุฌูุฏู ููููุชุจ ูู *$230*.";
    } else if (userMessage.includes("ููุชุจุฉ")) {
      reply = "๐ ุณุนุฑ ุงูููุชุจุฉ ุงูุฌุฏุงุฑูุฉ ุงูุฎุดุจูุฉ ูู *$270*.";
    } else if (userMessage.includes("ุชูุตูู") || userMessage.includes("ุดุญู")) {
      reply = info.delivery;
    } else if (userMessage.includes("ุถูุงู")) {
      reply = info.warranty;
    } else if (userMessage.includes("ูุฑูุน")) {
      reply = info.branches;
    } else if (userMessage.includes("ุฎุจุฑุฉ")) {
      reply = info.experience;
    } else if (userMessage.includes("ููุงุฐุง") || userMessage.includes("ุชุฎุชุงุฑูุง")) {
      reply = info.whyUs;
    } else if (userMessage.includes("ุชูุงุตู") || userMessage.includes("ุฑูู") || userMessage.includes("ุฅูููู")) {
      reply = info.contact;
    } else if (userMessage.includes("ุขุฑุงุก") || userMessage.includes("ุชูููู") || userMessage.includes("ุนููุงุก")) {
      reply = info.reviews;
    } else if (userMessage.includes("ุดูุฑุง") || userMessage.includes("ุดูุฑุงู")) {
      reply = "๐ ุงูุนูู! ูุณุนุฏูุง ุฏุงุฆููุง ุฎุฏูุชู ๐ ูุง ุชุชุฑุฏุฏ ูู ุงูุณุคุงู ุนู ุฃู ููุชุฌ.";
    } else {
      reply =
        "๐ ููููู ุณุคุงูู ุนู ุงูุฃุณุนุงุฑ ุจุงูุฏููุงุฑุ ุงูููุชุฌุงุชุ ุงูุชูุตููุ ุงูุถูุงูุ ุฃู ุขุฑุงุก ุงูุนููุงุก ูุณุฃุฎุจุฑู ุจุงูุชูุงุตูู ุจุฏูุฉ.";
    }

    return new Response(JSON.stringify({ reply }), {
      status: 200,
      headers: { "Content-Type": "application/json; charset=utf-8" },
    });
  } catch (err) {
    console.error("โ ุฎุทุฃ ูู ุงูุฎุงุฏู:", err);
    return new Response(
      JSON.stringify({ reply: "โ๏ธ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ูุนุงูุฌุฉ ุงูุฑุณุงูุฉ. ุญุงูู ูุฌุฏุฏูุง ูุงุญููุง." }),
      { status: 500, headers: { "Content-Type": "application/json" } }
    );
  }
}
